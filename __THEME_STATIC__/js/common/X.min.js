window.NY=window.NY||{},NY.constant=function(){return{DEFAULT_BUSY_TEXT:"服务器繁忙，请稍后重试！",DEFAULT_TIPS_TITLE:"消息",DEFAULT_TIPS_ERROR_TITLE:"错误提醒",DEFAULT_TIPS_LOADING_TITLE:"加载中",UPLOAD_FILE_ERROR_TEXT:"文件格式不符合或文件大小超限",UPLOAD_FILE_IMG_PREFIX:"",DATE_NORMAL_FORMAT:"yyyy-M-dd HH:mm:ss",DATA_ARRAY2MAP_DEFAULT_KEYNAME:"id",DATA_ARRAY2MAP_DEFAULT_VALUENAME:"name",DEFAULT_TIPS_SHOW_DURATION:3,DEFAULT_KEYNAME:"id",DEFAULT_VALUENAME:"name"}}(),NY.regEx=function(){return{passwordRegEx:"^(?=.*[0-9])(?=.*[a-zA-Z])^[\\w\\(\\)\\~\\!\\@\\#\\$\\%\\^\\&\\*\\-\\+\\=\\|\\{\\}\\[\\]\\:\\;\\<\\>\\,\\.\\?/]{8,30}$"}}(),$(function(){NY.constant.STATIC_SOURCES_PATH="/"}),NY.date=function(){var e=function(e){return $.format.date(e,NY.constant.DATE_NORMAL_FORMAT)},t=function(e,t){var n={all:-1,year:0,month:1,day:2,hour:3,minute:4,second:5,none:6},a=$.extend({unitYear:"年",unitMonth:"个月",unitDay:"天",unitHour:"小时",unitMinute:"分钟",unitSecond:"秒",invalidTimeText:"-",isShowEmptyUnit:!0,padZeroLevel:"minute",maxShowUnit:"all",useMillisecond:!1},t);if(!$.isNumeric(e)||e<=0)return a.invalidTimeText;var r=e;a.useMillisecond&&(r=Math.round(e/1e3));var i=[],o=[31536e3,2592e3,86400,3600,60,1],l=[a.unitYear,a.unitMonth,a.unitDay,a.unitHour,a.unitMinute,a.unitSecond],s=n[a.padZeroLevel],c=n[a.maxShowUnit];$.each(o,function(e,t){if(!(e<c||r<t&&0==i.length)){var n=Math.floor(r/t);r%=t,e>=s&&n<10&&(n="0"+n),(0!==Number(n)||a.isShowEmptyUnit)&&i.push(n+l[e])}});var u=i.join("");return u?0===u.indexOf("0")&&(u=u.slice(1)):u=a.invalidTimeText,u};return{format:e,now:function(){return e(new Date)},transformTime:t,getIncrementTime:function(e,t){return Number(new Date(t||new Date))+Number(e||0)},getDecrementTime:function(e,t){return Number(new Date(t||new Date))-Number(e||0)}}}(),NY.number={priceFormat:function(e){for(var t=String(parseInt(e)),n="",a=t.length,r=0;r<a;){var i;i=0==r?t.slice(-r-3):t.slice(-r-3,-r)+",",n=i+n,r+=3}var o=String(e),l="";return-1!==o.indexOf(".")&&(l="."+o.split(".")[1]),n+l},dataPatchFormat:function(e,t,n){if(!e)return e;var a=String(e)||"";return(t=t||6)<a.length?e:(NY.string.createRepeatChar(n||"0",t)+e).slice(-t)},toFixed:function(e,t){return Number(e).toFixed(t||2)},getInt:function(e){return parseInt(e)},getDecimals:function(e,t){return t=t||2,this.toFixed(e,t).slice(-(t+1))}},NY.string={isEqual:function(e,t,n){return e=String(e),t=String(t),!1!==n&&(e=e.toLowerCase(),t=t.toLowerCase()),e==t},isEmpty:function(e,t){var n=!1;switch(e){case"":n=!0;break;case void 0:case null:case!1:n=!t;break;default:n=!1}return n},removeInsideSpace:function(e){return String(e||"").replace(/\s+/g,"")},initial:function(e){return e=String(e||""),e.charAt(0).toUpperCase()+e.slice(1)},breakLineToArray:function(e){return e=String(e||""),e.split(/\r?\n/g)},createRepeatChar:function(e,t){return t=Number(t)+1||0,new Array(t).join(e)}},NY.util=function(){var e=function(e){return Array.prototype.slice.call(e)},t=function(){var t=$.map(e(arguments),function(e){return $(e)[0]});return $(t[0])},n=function(e){return($(e).prop("tagName")||"").toLowerCase()},a=function(e,t){return NY.string.isEqual(n(e),t)},r=function(e,n){return t($(n),$("#postForm"),$("form")).find("[name="+e+"]")},i=function(){var t={};return function(n,a,r){var i=e(arguments),o=i.shift();return clearTimeout(t[o]),t[o]=window.setTimeout.apply(null,i)}}();return{argumentsToArray:e,setTimeout:i,getFirstInCollection:t,getFieldByName:r,getTagName:n,isTagName:a,encodeHtmlTag:function(e){if(!e)return e;var t=function(e){return e.replace(/</gm,"&lt;").replace(/>/gm,"&gt;")},n=null;return"string"==typeof e?n=t(e):(n={},$.each(e,function(e,a){n[e]="string"==typeof a?t(a):a})),n}}}(),NY.data={arrayToMap:function(e,t,n){e=e||[],t=t||NY.constant.DATA_ARRAY2MAP_DEFAULT_KEYNAME,n=n||NY.constant.DATA_ARRAY2MAP_DEFAULT_VALUENAME;var a={};return $.each(e,function(e,r){a[r[t]]=r[n]}),a},stringToArray:function(e,t,n){return e=String(e||""),t=t||",",n=!1!==n,n&&(e=NY.string.removeInsideSpace(e)),e.split(t)}},NY.feedback=function(){var e=function(){var e=null,t={type:"success",text:"操作成功",duration:3,closedCallback:$.noop},n=function(n){if(e||(e=$("#nyFeedback")),!e.length)return void console.warn("找不到 #nyFeedback 元素");var a=e.data("feedback");a&&a!==this&&a.hide();var r=e,i=r.find(".ui-feedback"),o=i.find(".ui-feedback-close"),l=$.extend({},t,n),s=this,c=null;i.removeClass().addClass("ui-feedback ui-feedback-"+l.type),i.find(".ui-feedback-text").html(l.text),l.duration>0&&(c=setTimeout(function(){s.hide()},1e3*l.duration+400)),o.bind("click.closeFeedback",function(){s.hide()}),r.data("feedback",s),this.show=function(){return r.show(),i.hide(),i.slideDown(400),s},this.hide=function(){return r.stop(!0,!0).hide(),l.closedCallback.call(i),s.destory(),s},this.destory=function(){clearTimeout(c),o.unbind("click.closeFeedback"),r.data("feedback",null),delete s.show,delete s.hide,delete s.destory,r=null,i=null,o=null,l=null,s=null,c=null}};return n}(),t=["success","warn","info","error"],n={};return $.each(t,function(t,a){n[a]=function(t,n,r){var i=new e({type:a,text:t,duration:$.isNumeric(n)?n:3,closedCallback:r||$.noop});return i.show(),i}}),n}(),NY.tips=function(){var e={},t=["success","warn","error","info"];return $.each(t,function(t,n){e[n]=function(e){var t=$.extend(!0,{icon:"uc_"+n,title:"提示信息",content:"",subTipContent:"",padding:"48px 80px 40px 10px",time:NY.constant.DEFAULT_TIPS_SHOW_DURATION,close:$.noop},e);if(t.subTipContent){var a=['<p class="sub-tip">',t.subTipContent,"</p>"].join("");if("string"==typeof t.content)t.content+=a;else{var r=$(t.content).wrap("<div>").parent();r.append(a),t.content=r[0]}}return(t.ok||t.cancel||t.button)&&(t.time=e.time||0),delete t.subTipContent,window.parent.$.dialog(t)}}),e.showBusy=function(t){return e.error($.extend({content:NY.constant.DEFAULT_BUSY_TEXT},t))},e.ask=function(t){return e.success($.extend({icon:"uc_ask",title:"确认？",cancel:!0},t))},e}(),function(){var e=["success","warn","error","showBusy"];$.each(e,function(e,t){NY[t]=function(e,n,a){var r={content:e,time:n,close:a};return NY.tips[t](r)}})}(),$(function(){var e=$("#nyWaitingTip");NY.waiting=function(t,n){e.find(".loading-tip-text").html(t),n?e.find(".ny-loading-mask").show():e.find(".ny-loading-mask").hide(),e.show()},NY.hideWaiting=function(){e.hide()}}),NY.dom=function(){var e=function(e,t){var n=$(e),a=$(t||"form");if(!a.length)return!1;n.find("[data-name]").each(function(e,t){var n=$(t),r=n.data("name"),i=n.data("value")||n.html(),o=a.find("[name="+r+"]");if(n.length&&o.length){switch(n.data("type")||n.attr("type")){case"radio":case"checkbox":o[0].checked=n[0].checked;break;case"text":o.html($.trim(i));break;default:o.val($.trim(i))}}})};return{scrollToBottom:function(e){var t=$(e);t.scrollTop(t[0].scrollHeight)},setChecked:function(e){$(e).prop("checked",!0)},setUnchecked:function(e){$(e).prop("checked",!1)},fillFormByContainer:e,fillFormByTr:function(t,n){var a=$(t);if(NY.util.isTagName(a,"tr")||(a=a.parents("tr")),!a.length)return!1;e(a,n)},createRowByForm:function(e,t,n){var a=$(t||"form");if(!a.length)return!1;var r=null,i={};return a.find("[name]").each(function(e,t){var n=$(t),a=n.data("type")||n.attr("type"),r=n.attr("name"),o=n.val(),l=NY.util.getTagName(n);if(o||"input"==l||"select"==l||(o=n.html()),"checkbox"==a||"radio"==a){o=t.checked?n.data("checked_value"):n.data("unchecked_value")}i[r]=o}),$.isFunction(n)?r=n.call(i,i)||i:n?(r={},r[n]=i):r=i,template(e,r)},resetForm:function(e,t){var n=NY.util.getFirstInCollection($(e),$("form"));t=t||"reset_value",n.length&&(n[0].reset(),n.find("[name]").each(function(){var e=$(this),n=e.data(t);if(void 0!==n){"text"==(e.data("type")||e.attr("type"))?e.html(n):e.val(n)}}))},clearForm:function(e){var t=NY.util.getFirstInCollection($(e),$("form"));t.length&&t.find("[name]").each(function(){var e=this.type,t=$(this);switch(e){case"button":case"submit":case"reset":case"image":return;case"radio":case"checkbox":t.prop("checked",!1);break;default:t.val("")}})},createSelectOptions:function(e,t,n){return e=e||[],t=t||NY.constant.DEFAULT_KEYNAME,n=n||NY.constant.DEFAULT_VALUENAME,$.map(e,function(e,a){var r=$("<option>").text(e[n]).val(e[t]);return r.data("source",e),r})},fillSelectOptions:function(e,t,n,a){$(e).append(this.createSelectOptions(t,n,a))},createCountDown:function(e,t){var n=$(e),a=$.extend({time:60,waitingText:"{%t}秒后重新发送",finalContent:"点击再次发送",disabledClassName:"disabled",intervalSecond:1,callback:function(){}},t),r=a.finalContent,i=a.disabledClassName,o=a.intervalSecond,l=function(e){return a.waitingText.replace("{%t}",e)};n.each(function(e){var t=$(this),n=function(e){return"INPUT"==t.prop("nodeName").toUpperCase()?t.val(e).val():t.html(e).html()},s=a.time,c=n(),u=function(){n(l(s)),t.prop("disabled",!0),t.addClass(i)},d=setInterval(function(){s>1?(s--,u()):(n(r||c),t.prop("disabled",!1),t.removeClass(i),clearInterval(d),a.callback.call(t,a))},1e3*o);u()})}}}(),NY.event=function(){var e=function(e,t,n){n=n||{};var a=n.eventType||"keypress",r=n.eventData,i=n.isCtrlKey,o=n.isShiftKey,l=n.isAltKey,s=function(e){return"boolean"==typeof e},c=function(e){var n=e.which,a=this;if(10==n||13==n){if(s(i)&&i!==e.ctrlKey)return;if(s(o)&&o!==e.shiftKey)return;if(s(l)&&l!==e.altKey)return;t.call(a,e)}};return $(e)[a](r,c)},t=function(t){return function(n,a,r){return r=r||{},r.eventType=t,e(n,a,r)}},n=function(e,t){var n=$.extend({isLimitInt:!1,min:1,max:void 0},t),a=n.isLimitInt,r=n.min,i=n.max;$(e).keydown(function(e){var t=$(this),n=e.which;if(e.shiftKey)return!1;var r=110==n||190==n;if(a&&r)return!1;var i=n>=48&&n<=57||n>=96&&n<=105,o=8==n||37==n||38==n||39==n||40==n||35==n||36==n||46==n;if(!r&&!i&&!o)return!1;var l=t.val(),s=l.indexOf(".");return(-1==s||!r)&&(!(s>=0&&l.length-s>2&&i)&&void 0)}).blur(function(){var e=$(this),t=parseFloat(e.val());if(!$.isNumeric(t))return void e.val(r);var n=Math.max(r,t);i&&(n=Math.min(i,n)),e.val(n)})};return{enterPress:e,enterUp:t("keyup"),enterDown:t("keydown"),inputNumberLimit:n}}(),NY.ajax=function(e,t){"object"==typeof e&&(t=e,e=void 0);var n=!1!==t.isShowWaitTip,a=$.extend({url:e,type:"post",dataType:"json",error:function(){NY.showBusy()},beforeSend:function(){NY.waiting("加载中，请稍后...",!0)},complete:function(e,t){n&&NY.hideWaiting()}},t);return delete a.isCoverSuccess,delete a.successResultFalse,delete a.isSuccessShowTip,delete a.isSuccessJump,delete a.isResultFalseWarn,delete a.waitText,delete a.isShowWaitTip,delete a.isShowWaitMask,delete a.waitMaskStyle,!0!==t.isCoverSuccess&&(a.success=function(e,n,a){var r=this,i=e.text,o=e.time;if(!e.result){var l=function(){var i=t.successResultFalse;$.isFunction(i)&&i.call(r,e,n,a)};return void(!1!==t.isResultFalseWarn?NY.warn(i,o,function(){l()}):l())}var s=function(){var i=t.success,o=!0;$.isFunction(i)&&(o=i.call(r,e,n,a)),!1!==t.isSuccessJump&&!1!==o&&(e.url?window.location.href=e.url:e.reload&&window.location.reload())};!1!==t.isSuccessShowTip&&i?NY.success(i,o,function(){s()}):s()}),n&&NY.waiting(t.waitText,t.isShowWaitMask),$.ajax(a)},$.each(["get","post"],function(e,t){NY[t]=function(e,n){return n=n||{},n.type=t,"get"==t&&(n.cache=!1),NY.ajax(e,n)}}),NY.jsonp=function(e,t){"object"==typeof e&&(t=e,e=void 0);var n=$.extend(!0,{url:e,dataType:"jsonp",data:{format:"jsonp"}},t),a=-1==n.url.indexOf("?")?"?":"&";return n.url+=a+"jsoncallback=?",NY.ajax(n)},NY.mAjax=function(e,t){"object"==typeof e&&(t=e,e=void 0);var n=!1!==t.isShowWaitTip,a=$.extend({url:e,type:"post",dataType:"json",error:function(){mui.nyTip(NY.constant.DEFAULT_BUSY_TEXT,3,"error")},beforeSend:function(){mui.nyTip("加载中...",100,"loading")},complete:function(e,t){n&&$(".ny-show-loading").parent().remove()}},t);return delete a.isCoverSuccess,delete a.successResultFalse,delete a.isSuccessShowTip,delete a.isSuccessJump,delete a.isResultFalseWarn,delete a.waitText,delete a.isShowWaitTip,delete a.isShowWaitMask,delete a.waitMaskStyle,!0!==t.isCoverSuccess&&(a.success=function(e,n,a){var r=this,i=e.text||"操作成功!",o=e.time||1;if(!e.result){var l=function(){var i=t.successResultFalse;$.isFunction(i)&&i.call(r,e,n,a)};return void(!1!==t.isResultFalseWarn?mui.alert(i," ",function(){l()}):l())}var s=function(){var i=t.success,o=!0;$.isFunction(i)&&(o=i.call(r,e,n,a)),!1!==t.isSuccessJump&&!1!==o&&(e.url?window.location.href=e.url:e.reload&&window.location.reload())};!1!==t.isSuccessShowTip&&i?mui.nyTip(i,o,"success",function(){s()}):s()}),$.ajax(a)},$.each(["mGet","mPost"],function(e,t){NY[t]=function(e,n){return n=n||{},n.type=t,"get"==t&&(n.cache=!1),NY.mAjax(e,n)}}),NY.biz={createTextMapHelper:function(e,t,n,a){var r=$.isArray(t)?NY.data.arrayToMap(t,n,a):t;template.helper(e,function(e){return r[e]})},createObjectMapHelper:function(e,t,n){var a=t[n||"__default__"]||{};template.helper(e,function(e,n){return(t[e]||a)[n]})},multiUpload:function(e,t){var n=$.extend(!0,{maxAttachments:5,attachmentItemHtml:template("attachment",{}),containerSelector:".added-img-container",addButtonSelector:".add-attachment-btn",deleteButtonSelector:".delete-attachment",uploadingClassName:"attachment-uploading",doneClassName:"attachment-done",errorCall:function(e,t){NY.feedback.error(NY.constant.UPLOAD_FILE_ERROR_TEXT,5)}},e),a=n.maxAttachments,r=n.attachmentItemHtml,i=$(n.containerSelector),o=$(n.addButtonSelector),l=n.deleteButtonSelector,s=n.uploadingClassName,c=n.doneClassName,u=n.errorCall;o.each(function(){var e=o.parent(),n=$.extend(!0,{browse_button:this,multi_selection:!0,onFilesAdded:function(t,n){for(var o=i.children().length,l=a-o,s=Math.min(n.length,l),c=0;c<s;c++)i.append(r);if(o+n.length>=a){var u=navigator.appName,d=navigator.appVersion;d.split(";");"Microsoft Internet Explorer"==u?e.addClass("attachment-add-disappear"):e.hide()}},onFileUploaded:function(e,t,n,a){var r=i.find("."+s).first(),o=r.find("img");if(e.result){if(!r.length)return;r.removeClass(s),r.addClass(c),o.data("file_path",e.url),o.data("attachmentid",e.attachmentid),NY.plupload.previewImage(n,function(e){o.attr("src",e)},{unpreviewCallback:function(t){o.attr("src",NY.constant.UPLOAD_FILE_IMG_PREFIX+e.url)}})}else o.parent().remove(),NY.warn(e.text||"上传失败，请重试！")},onError:u},t);NY.plupload.createUploader(n);i.on("click",l,function(){var t=$(this).parent();t.fadeOut(function(){t.remove();var n=navigator.appName,a=navigator.appVersion;a.split(";");"Microsoft Internet Explorer"==n?e.removeClass("attachment-add-disappear"):e.show()})})})},getListTable:function(){var e=$(".pager-wrapper").prev("table");return e.length?e:null},useNoneDataFallback:function(e,t,n){if(nyData.pager&&!nyData.pager.total){var a=$(e);a.length||(a=NY.biz.getListTable());var r=!(!nyData.filter||NY.string.isEmpty(nyData.filter.searchKey)),i=r?n||"noneSearchRecordTdTpl":t||"nonedataTdTpl",o=0;a.find("tr").first().children().each(function(e,t){o+=Number($(t).attr("colspan"))||1});NY.util.getFirstInCollection(a.find("tbody"),a).append(template(i,{cols:o,text:a.data("nonedata_text")||"暂无数据",searchKey:r?nyData.filter.searchKey:"",subtext:a.data("nonedata_subtext"),subtextLink:a.data("nonedata_subtext_link")}))}},makeListTableSortable:function(e){var t=NY.util.getFirstInCollection($(e),NY.biz.getListTable());if(t.length){var n=nyData.filter||{},a=n.orderName,r=n.orderType;t.find("thead th[data-order_name]").each(function(){var e=$(this),t=e.data("order_name"),n=$('<a href="#a_null" class="filter-icon"></a>');t==a&&("desc"==r?(n.addClass("filter-desc"),e.data("order_type","desc")):"asc"==r&&n.addClass("filter-asc")),e.append(n).addClass("th-sortable")}),t.find("thead").on("click","th[data-order_name]",function(){var e=$(this),t=e.data("order_name"),a="desc"==e.data("order_type")?"asc":"desc",r=$.param($.extend(n,{orderName:t,orderType:a}));window.location=window.location.pathname+"?"+r})}},initSearchForm:function(){$(".ny-search-group").each(function(){var e=$(this),t=e.next();if($(".ny-search-dropdown").length){var n=NY.util.getFieldByName("searchType",t),a=nyData.filter.searchType;void 0!==a&&""!==a?n.val(a):a=n.val(),NY.component.initDropDown({containerSelector:e,defaultOptionValue:a})}nyData.filter&&!NY.string.isEmpty(nyData.filter.searchKey)&&NY.util.getFieldByName("searchKey",t).val(nyData.filter.searchKey),e.removeClass(".ny-dropdown-container")})},chooseAllInTable:function(e,t){var n=$.extend({checkboxGroupSelector:"input:checkbox",parmContainerSelector:""},t),a=$(e),r=$(n.parmContainerSelector);if(r.length||(r=a.parents("table")),a.length&&r.length){var i=r.find(n.checkboxGroupSelector);a.change(function(){var e=$(this).prop("checked");i.prop("checked",e)})}}},NY.plupload=function(){var e=function(e){e=e||{};var t=$.noop,a=$.extend({pluploadBasePath:"/static/uc/lib/plugin/plupload/js/",isAutoInit:!0,isAutoUpload:!0,isEasyGetFile:!1,onFilesAdded:t,onUploadProgress:t,onFileUploaded:t,onError:t,isParseResponseJSON:!0,previewImgElement:null},e);delete e.pluploadBasePath,delete e.isAutoInit,delete e.isAutoUpload,delete e.isEasyGetFile,delete e.onFilesAdded,delete e.onUploadProgress,delete e.onFileUploaded,delete e.onError,delete e.isParseResponseJSON,delete e.previewImgElement;var r=a.pluploadBasePath,i=$.extend(!0,{browse_button:"uploadFileButton",url:"/user/upload/",runtimes:"html5,flash,silverlight,html4",flash_swf_url:r+"Moxie.swf",silverlight_xap_url:r+"Moxie.xap",multi_selection:!1,filters:{mime_types:[{title:"Image files",extensions:"jpg,png"}],max_file_size:"1mb",prevent_duplicates:!1}},e),o=new plupload.Uploader(i);if(a.isAutoInit){o.init();var l=$(a.previewImgElement),s=!!l.length;o.bind("FilesAdded",function(e,t){var r=i.multi_selection?t:t[0];a.isEasyGetFile&&1==t.length&&(r=t[0]),a.onFilesAdded.call(this,e,r),s&&!i.multi_selection&&n(r,l),a.isAutoUpload&&e.start()}),o.bind("UploadProgress",a.onUploadProgress),o.bind("FileUploaded",function(e,t,n){var r=n.response;a.isParseResponseJSON&&(r=$.parseJSON(n.response)),a.onFileUploaded.call(this,r,e,t,n)}),o.bind("Error",a.onError)}return o},t=function(e,t,n){var a=$.extend({isDownsize:!0,downsizeWidth:200,downsizeHeight:200,unpreviewCallback:function(e){}},n);if(e&&/image\//.test(e.type)){var r=e.getSource();if(!e.loaded||!r.size)return void a.unpreviewCallback(e);if("image/gif"==e.type){var i=new mOxie.FileReader;i.onload=function(){t&&t(i.result),i=null},i.readAsDataURL(e.getSource())}else{var o=new mOxie.Image;o.onload=function(){a.isDownsize&&o.downsize(a.downsizeWidth,a.downsizeHeight);var e="image/jpeg"==o.type?o.getAsDataURL("image/jpeg",80):o.getAsDataURL();t&&t(e),o.destroy&&o.destroy(),o=null},o.load(r)}}},n=function(e,n){t(e,function(e){$(n).attr("src",e)})};return{createUploader:e,previewImage:t,setPreviewImage:n}}(),NY.component=function(){return{initPagination:function(e,t){var n=$(e);if(n.length){var a=n.find(".page-number"),r=a.children().first().clone(),i=nyData.pager||{},o=i.page,l=Math.max(Math.ceil(i.total/i.pageSize),1),s=Math.min(7,l),c=[{button:n.find(".pager-first"),targetPageNumber:1},{button:n.find(".pager-last"),targetPageNumber:l},{button:n.find(".pager-prev"),incrementPageNumber:-1},{button:n.find(".pager-next"),incrementPageNumber:1}],u=function(e){var t=0;if(e.targetPageNumber)t=e.targetPageNumber;else if(e.incrementPageNumber){var n=Number(a.find(".page--current").html());t=n+Number(e.incrementPageNumber)}return t},d=function(e){var t=Math.max(e-3,1),n=Math.min(l,e+3);n-t+1<s&&(t<3&&(n=s),l-e<3&&(t=Math.max(n-6,1))),a.empty();for(var i=t;i<=n;i++){var o=i,d=o==e?"page--current":"";r.clone().html(o).addClass(d).appendTo(a)}$.each(c,function(t,n){var a=n.button,r=u(n);if(!r)return void a.addClass("disabled");n.targetPageNumber?r===e?a.addClass("disabled"):a.removeClass("disabled"):n.incrementPageNumber&&(r<1||r>l?a.addClass("disabled"):a.removeClass("disabled"))})};d(o),t=t||$.noop;var p=function(e,n){e=Number(e);var a=[e].concat(NY.util.argumentsToArray(n));!1!==t.apply(this,a)&&d(e)};a.on("click",".page-button:not(.page--current)",function(e){var t=$(this),n=t.html();p.call(this,n,arguments)}),$.each(c,function(e,t){var n=t.button;n.click(function(){if(!n.hasClass("disabled")){var e=u(t);p.call(this,e,arguments)}})})}},initTabs:function(e){var t=$.extend(!0,{containerSelector:".ny-tab-container",tabGroupDataName:"tab_group",selectedClassName:"ny-tab-selected",controlClassNamePre:"tab-group-"},e),n=$(t.containerSelector);if(n.length){var a=t.tabGroupDataName,r=t.selectedClassName,i=t.controlClassNamePre;n.each(function(){var e=$(this),t=e.find("[data-"+a+"]");e.addClass(i+t.first().data(a));var n="";t.each(function(){n+=i+$(this).data(a)+" "}),t.click(function(){var t=$(this);t.addClass(r).siblings().removeClass(r),e.removeClass(n),e.addClass(i+t.data(a))})})}},initDropDown:function(e){var t=$.extend(!0,{containerSelector:".ny-dropdown-container",containerBindDataName:"field_name",dropItemDataName:"drop",activeClassName:"ny-drop-active",defaultOptionClassName:"ny-default-option",defaultOptionValue:"",selectedContentClassName:"selected-content"},e),n=$(t.containerSelector),a=t.containerBindDataName,r=t.dropItemDataName,i=t.activeClassName,o=t.defaultOptionClassName,l=t.defaultOptionValue,s=t.selectedContentClassName;n.each(function(){var e=$(this),t=e.find("."+s),n=$("[name="+e.data(a)+"]"),c=e.find("[data-"+r+"]");l&&e.find("[data-"+r+"="+l+"]").addClass(o);var u=e.find("."+o);u.length?(u.addClass(i),t.html(u.html()),n.val(u.data(r))):(c.first().addClass(i),t.html(c.first().html()),n.val(c.first().data(r)));var d=e.find(".dropdown-toggle"),p=e.find(".dropdown-menu");p.show();var f=d.outerWidth(),m=p.outerWidth(),h=0;h=m>f?m+18:f+8,d.outerWidth(h),p.outerWidth(h),c.click(function(){var e=$(this);c.removeClass().removeClass(i),e.addClass(i),t.html(e.html()),n.val(e.data(r)),n.trigger("change")})})},initNumber:function(e){var t={inputSelector:".ny-number-input",min:1,max:1e4,step:1,unit:""};$(t.inputSelector).each(function(){var n=$(this),a=$.extend(!0,{},t,{min:n.data("num_min"),max:n.data("num_max"),step:n.data("num_step"),unit:n.data("num_unit")},e),r=parseInt(a.min),i=parseInt(a.max),o=parseInt(a.step),l=a.unit,s=$(['<div class="ny-number-container">','<span class="number-input-box">','<span class="ny-number-unit">'+l+"</span>","</span>",'<span class="ny-number-control">','<span class="number-control-up"></span>','<span class="number-control-down"></span>',"</span>","</div>"].join(""));n.before(s),s.find(".number-input-box").prepend(n.clone()),n.remove(),n=s.find(".ny-number-input");var c=function(e){return $(e).parents(".ny-number-container").find(a.inputSelector)},u=function(e){var t=e?c(e):n,a=t.val(),o=Math.max(Math.min(a,i),r);t.val(isNaN(o)?r:o)};u(),n.change(function(){u(this)});var d=s.find(".number-control-up"),p=s.find(".number-control-down");d.click(function(){var e=c(this),t=parseInt(e.val());t+=o,e.val(Math.min(t,i)),e.trigger("change")}),p.click(function(){var e=c(this),t=parseInt(e.val());t-=o,e.val(Math.max(t,r)),e.trigger("change")}),$(".number-input-box").click(function(){$(this).find(n).focus()})})}}}(),NY.validater=function(){var e=function(e){var t=$(e);t.find(".validate-control input").removeClass("error-input"),t.find(".error-reminder").empty()},t=function(t,n,a,r){var i=null;i="string"==typeof t?NY.util.getFieldByName(t,$(a)):$(t),e(a),i.addClass("error-input").focus().parents(".validate-control").find(".error-reminder").html(n),!1!==r&&i.blur(function(){$(this).val()&&e(a)})};return{clearValidateError:e,validateShowError:t,formValidate:function(e,n){var a=$(e),r=!0;return!n||($.each(n,function(e,n){var i=NY.util.getFieldByName(e,a),o=i.val(),l=new RegExp(n.regexp)||{},s=n.remindWords||"该项输入不合法";n.required&&(o||(r=!1,t(i,s,a))),l.test(o)||(r=!1,t(i,s,a))}),r)},mobileFormValidate:function(e,n){var a=$(e),r=!0;return!n||($.each(n,function(e,n){var i=NY.util.getFieldByName(e,a),o=i.val(),l=new RegExp(n.regexp)||{},s=n.remindWords||"该项输入不合法";n.required&&(o||(r=!1,t(i,s,a),mui.alert(s))),l.test(o)||(r=!1,mui.alert(s))}),r)}}}(),NY.proxyRenderer={renderContent:function(e,t,n){var a=e||$("#contentBox");t=t||nyData,n=n||"contentTemplate",a.html(template(n,t)),NY.proxyRenderer.renderPagination(),NY.biz.useNoneDataFallback(),NY.biz.makeListTableSortable(),NY.component.initTabs(),NY.biz.initSearchForm()},renderPagination:function(e){var t=$(e||"#pager");if(t.length)return nyData.pager&&0!=nyData.pager.total?void NY.component.initPagination(t,function(e,t){var n=$.param($.extend({page:e},nyData.filter));window.location=window.location.pathname+"?"+n}):void t.hide()}};